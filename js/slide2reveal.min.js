(function(){"use strict";function Slide2Reveal(element,showPercent){var s2r={'base':{},'slider':{},'tooltip':{}},container=element,suffix=showPercent,args=arguments;function config(){function verifyHTMLElement(){var testel,result=0;if(container&&typeof container==="object"){if('jquery'in container){if(!container[0]){terminate();}else{result=2;testel=container[0];}}else{testel=container;}if(testel.nodeType===1||Object.prototype.toString.call(testel).match(/^\[object\s(.*)\]$/)[1]==="HTMLElement"||testel.constructor.ELEMENT_NODE===1){result=1;}}else{terminate();}return result;}function buildBase(){var audit=verifyHTMLElement();if(audit){if(audit===2){s2r.base=container[0];}if(audit===1){s2r.base=container;}}else{terminate();}}function configBase(){var imgArr={},imgArrLen=0;if(s2r.base){s2r.suffix=(typeof suffix==='undefined'||suffix===1)?1:0;imgArr=s2r.base.querySelectorAll('.s2r-stack');imgArrLen=imgArr.length;s2r.image=(imgArrLen!==0&&imgArrLen>1)?imgArr[imgArrLen-1]:imgArr[1];}else{terminate();}}function configSlider(){s2r.slider=s2r.base.querySelector('.s2r-slider');s2r.slider.pos=getRect(s2r.slider);s2r.slider.attr={'min':s2r.slider.getAttribute('min'),'max':s2r.slider.getAttribute('max'),'mid':s2r.slider.getAttribute('max')/2,'len':s2r.slider.getAttribute('max')-s2r.slider.getAttribute('min')};s2r.slider.valueAsPercent=function(){return Math.floor(((s2r.slider.value-s2r.slider.attr.min)/(s2r.slider.attr.max-s2r.slider.attr.min))*100);}}function getRect(obj){return obj.getBoundingClientRect();}function configTooltip(){s2r.tooltip=s2r.base.querySelector('.s2r-tooltip');s2r.tooltip.pos=getRect(s2r.tooltip);s2r.tooltip.startx=s2r.slider.pos.left-s2r.tooltip.pos.left;}function setup(){buildBase();configBase();configSlider();configTooltip();}setup();}function terminate(){if(document.querySelector('.s2r-tooltip')){var el=document.querySelector('.s2r-tooltip');el.innerHTML='Error';el.style.fontSize='11px';el.style.color='red';}}function updateTooltipMessage(tooltip,msg,onoff){var message=(onoff===1)?msg+'%':msg;tooltip.innerHTML=message;}function doAction(){reveal(s2r.slider.valueAsPercent());moveTooltip();updateTooltipMessage(s2r.tooltip,s2r.slider.valueAsPercent(),s2r.suffix);}function reveal(value){var w=s2r.image.offsetWidth,h=s2r.image.offsetHeight;s2r.image.style.clip='rect(0, '+w+'px'+', '+h+'px'+', '+pctValue(w,parseFloat(value))+'px)';}function setStartPos(){s2r.slider.value=s2r.slider.getAttribute('min');moveTooltip();updateTooltipMessage(s2r.tooltip,s2r.slider.valueAsPercent());}function pctValue(num,pct){if(isNaN(parseInt(num,10))||isNaN(parseInt(pct,10))){throw new TypeError("Function requires two (2) numbers as arguments.");}else{return Math.floor((num*pct)/100);}}function moveTooltip(){var sval=s2r.slider.value,ppos=s2r.slider.parentElement.getBoundingClientRect(),spos=s2r.slider.getBoundingClientRect(),swidth=parseInt(s2r.slider.offsetWidth),sleft=spos.left,twidth=s2r.tooltip.offsetWidth,pleft=ppos.left,startpos=Math.floor(sleft-pleft),endpos=startpos+(swidth-twidth),val=s2r.slider.valueAsPercent(),fsize=parseFloat(document.defaultView.getComputedStyle(s2r.tooltip,null).fontSize),lineheight=parseFloat(document.defaultView.getComputedStyle(s2r.tooltip,null).lineHeight),em=lineheight/fsize,charcount=s2r.tooltip.innerHTML.length,strlen=charcount*em,result=(pctValue((twidth/4),val)/4),subtotal=0,total=0;if(sval===s2r.slider.attr.min){subtotal=startpos;}else{if(sval===s2r.slider.attr.max){subtotal=endpos;}else{subtotal=pctValue((endpos-((twidth)/(charcount+1))),val)+(Math.sqrt(Math.pow(((twidth/strlen)/charcount),2)))+((twidth/em)/(charcount))+result;if(subtotal<startpos)subtotal=startpos;if(subtotal>endpos)subtotal=endpos;}}total=subtotal;s2r.tooltip.style.transform='translate3d('+total+'px, 0, 0)';}function init(){config();s2r.slider.addEventListener("input",doAction,false);setStartPos(s2r.slider,s2r.tooltip);updateTooltipMessage(s2r.tooltip,s2r.slider.value,s2r.suffix);}init();}window.Slide2Reveal=Slide2Reveal;})();